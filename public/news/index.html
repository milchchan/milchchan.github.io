<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-617KR1WTYP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-617KR1WTYP");
    </script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f4f4f2" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#f4f4f2" />
    <title>MILCHCHAN.COM NEWS</title>
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="apple-touch-icon" href="touch-icon-iphone.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="touch-icon-iphone-retina.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="touch-icon-ipad-retina.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;700&display=swap" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/922939073a.js" crossorigin="anonymous"></script>
    <style media="screen">
      :root {
        --background-color: #ffffff;
        --foreground-color: #000000;
        --milch-light-background-image: /images/Milchchan.png;
        --milch-dark-background-image: /images/Background-Milch-Zankuro-1.png;
        --merku-light-background-image: /images/Merkuchan.png;
        --merku-dark-background-image: /images/Background-Merku-Zankuro-1.png;
        --story-light-background-image: /images/Milch-Manga-01.png;
        --story-dark-background-image: /images/Milch-Manga-02.png;
      }

      html {
        touch-action: none;
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100vh;
        height: 100dvh;
        overflow-x: hidden;
        overflow-y: auto;
        scroll-behavior: smooth;
        background: #f4f4f2;
      }

      body {
        position: relative;
        margin: 0;
        padding: 0;
        width: 100%;
        min-height: 100vh;
        min-height: -webkit-fill-available;
        min-height: 100dvh;
        overflow: hidden;
      }

      h1 {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
        margin: 0px -4px 0px -4px !important;
        padding: 0;
        color: var(--foreground-color) !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 2rem;
        font-weight: bold;
        line-height: 2rem;
        text-transform: uppercase;
      }

      h1>span {
        margin: 0px 4px 0px 4px !important;
      }

      h2 {
        position: sticky;
        top: 0px;
        margin: 0;
        padding: 0;
        color: var(--foreground-color) !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 0.75rem;
        font-weight: bold;
        line-height: 0.75rem;
        text-transform: uppercase;
      }

      h1+h2 {
        margin: 8px 0px 0px 0px;
      }

      p+h2 {
        margin: 16px 0px 0px 0px;
      }

      p {
        margin: 16px 0px 0px 0px;
        padding: 0;
        color: var(--foreground-color) !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 1.25rem;
        line-height: 2rem;
      }

      p+div>div>span {
        margin: 0px 0px 0px 0px;
        padding: 0;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 1.0rem;
        line-height: 1.5rem;
      }

      p+div>span {
        margin: 0px 0px 0px 0px;
        padding: 0;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 0.75rem;
        line-height: 1rem;
      }

      div+div>span {
        margin: 0px 0px 0px 0px;
        padding: 0;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 0.75rem;
        line-height: 1rem;
      }

      ul,
      ol {
        margin-left: 0;
        padding-left: 0;
      }

      ul {
        margin: 16px 0px 0px 0px;
      }

      ul>li {
        margin: 0px 0px 0px 16px;
        padding: 0;
        list-style-type: none;
        color: var(--foreground-color) !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 1.25rem;
        line-height: 2rem;
      }

      a,
      a:focus,
      a:link,
      a:visited,
      a:hover,
      a:active {
        outline: none;
        text-decoration: none;
        color: var(--foreground-color);
      }

      a .scrollable {
        display: inline-block;
        box-sizing: content-box;
        backface-visibility: hidden;
        transform: translate3d(0%, 0%, 0);
        transition: 0.5s ease-in;
      }

      a .scrollable>div {
        -webkit-user-select: none;
        user-select: none;
        box-sizing: content-box;
        vertical-align: middle;
      }

      a .scrollable:hover {
        display: inline-block;
        box-sizing: content-box;
        backface-visibility: hidden;
        transform: translate3d(-100%, 0%, 0);
        transition: 0.5s ease-out;
      }

      .is-hidden {
        display: none !important;
      }

      .is-uppercase {
        text-transform: uppercase;
      }

      .is-italic {
        font-style: italic;
      }

      .has-text-weight-bold {
        font-weight: bold;
      }

      body>.wrap {
        position: absolute;
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        min-height: 100%;
        overflow: hidden;
        box-sizing: border-box;
        backface-visibility: hidden;
        transition: 0.5s;
      }

      body>.wrap>.frame {
        position: relative;
        margin: 0;
        padding: 0;
        border-radius: 0px;
        width: 100%;
        max-width: 100% !important;
        height: 100%;
        overflow: hidden;
        background-color: #f4f4f2;
        transition: 0.5s;
      }

      .background {
        -webkit-user-select: none;
        user-select: none;
        position: absolute;
        top: 16px;
        margin: 0;
        padding: 0;
        width: 100%;
        max-width: 100%;
        height: calc(100% - 32px);
        max-height: 100%;
        background-color: transparent;
        background-position: 50% 50%;
        background-repeat: no-repeat;
        background-attachment: scroll;
        background-size: contain;
        transform-origin: 50% 50%;
        backface-visibility: hidden;
        perspective: 1000;
      }

      .background::before {
        -webkit-user-select: none;
        user-select: none;
        position: absolute;
        margin: 0;
        padding: 0;
        width: 100%;
        max-width: 100%;
        height: 100%;
        max-height: 100%;
        overflow: hidden;
        background: transparent;
        content: "";
      }

      .background>div {
        -webkit-user-select: none;
        user-select: none;
        position: relative;
        opacity: 0;
        margin: 0;
        padding: 0;
        width: 100%;
        max-width: 100%;
        height: 100%;
        max-height: 100%;
        overflow: hidden;
        background-color: transparent;
        background-position: 50% 50%;
        background-repeat: no-repeat;
        background-attachment: scroll;
        background-size: contain;
        transform-origin: 50% 50%;
        backface-visibility: hidden;
        content: "";
        transition: .5s;
      }

      .background>div.is-touching {
        opacity: 0.5;
        transition: .5s;
      }

      .overlay {
        position: absolute;
        left: 0;
        top: 0;
        margin: 0;
        padding: 16px;
        width: 100%;
        height: 100%;
        min-height: 100%;
        overflow-x: hidden;
        overflow-y: auto;
        mask-image: linear-gradient(to bottom, transparent, black 16px, black calc(100% - 16px), transparent), linear-gradient(black, black);
        mask-size: calc(100% - 16px) 100%, 16px 100%;
        mask-position: 0 0, 100% 0;
        mask-repeat: no-repeat, no-repeat;
        animation: fade .5s ease-out forwards;
        box-sizing: border-box;
        backface-visibility: hidden;
        perspective: 1000;
        transition: 0.5s;
      }

      .overlay>.wrap {
        position: relative;
        box-sizing: border-box;
        margin: 0px 0px 0px calc(48px - 16px);
        padding: max(env(safe-area-inset-top, 0px), env(safe-area-inset-bottom, 0px)) max(env(safe-area-inset-right, 0px), env(safe-area-inset-left, 0px));
      }

      .overlay>.wrap>.content {
        position: absolute;
        margin: 0;
        padding: 0px 0px 16px 0px;
        width: 100%;
        transition: padding 0.5s;
        cursor: default;
      }

      .content p+div {
        margin: 16px 0px 0px 0px;
      }

      .content p+div.is-generated {
        margin: 0px 0px 0px 0px;
      }

      .content div+div {
        margin: 16px 0px 0px 0px;
      }

      .content div+div.is-generated {
        margin: 0px 0px 0px 0px;
      }

      .content>div:last-of-type {
        margin: 0 !important;
      }

      .content p a {
        display: inline;
        margin: 0;
        padding: 0;
        border: 0px solid transparent;
        background: transparent;
        background-clip: padding-box;
        backface-visibility: hidden;
        cursor: pointer;
      }

      .content p a .clip {
        position: relative;
        display: inline-flex;
        overflow: hidden;
        box-sizing: border-box;
      }

      .content p a .scrollable {
        display: inline-flex;
        margin: 0px -4px 0px -4px !important;
      }

      .content p a .scrollable span {
        display: inline;
        margin: 0px 4px 0px 4px !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        line-height: normal;
      }

      .content p a .scrollable span:last-child:not(:first-child) {
        position: absolute;
        left: 100%;
      }
      
      .overlay>.wrap>.content .icon.is-animatable {
        position: fixed;
        right: 16px;
      }

      .overlay>.wrap>.content>div>div>.icon.is-animatable {
        position: relative;
        right: auto;
        margin: 16px 0px 0px 0px;
      }

      div.sidebar {
        -webkit-user-select: none;
        user-select: none;
        z-index: 0;
        position: fixed;
        left: 0px;
        padding: env(safe-area-inset-top, 0px) 0px env(safe-area-inset-bottom, 0px) env(safe-area-inset-left, 0px);
        height: calc(100% - 32px);
        background: transparent;
        transition: 0.5s;
      }

      div.sidebar .separator {
        display: flex;
        flex-direction: row;
        align-items: flex-start;
        justify-content: center;
        width: 48px;
        height: fit-content;
      }

      div.sidebar .separator>hr {
        border-width: 0;
        margin: 0;
        padding: 0;
        width: 16px;
        height: 1px;
        background-color: #000000;
        text-align: center !important;
      }

      div.sidebar .button.is-selected .wrap {
        border-bottom: 2px solid #000000;
        transition: .5s ease-in;
      }

      div.sidebar .rotation-outer {
        display: inline-flex;
      }

      div.sidebar .rotation-outer>div.rotation-inner {
        padding: 50% 0;
        height: 0;
      }

      div.sidebar .rotation-outer>div.rotation-inner>div.rotate {
        display: block;
        transform-origin: top left;
        transform: rotate(-90deg) translate(0%, 100%) rotate(180deg);
        margin-top: -50%;
        white-space: nowrap;
      }

      div.sidebar>.level {
        display: flex;
        margin: 0;
        padding: 0;
        width: 48px;
        height: 100%;
        flex-direction: column;
        align-items: flex-start;
        justify-content: space-between;
      }

      div.sidebar>.level>.level-item>.level {
        display: flex;
        margin: -16px;
        padding: 0;
        flex-direction: column;
        align-items: flex-start;
        justify-content: space-between;
      }

      div.sidebar>.level>.level-item>.level>.level-item {
        display: flex;
        margin: 0;
        padding: 16px;
      }

      div.sidebar>.level>.level-item>.level>.level-item .icon {
        transform: rotate(-90deg);
      }

      div.sidebar .level>.level-item {
        margin: 0;
        padding: 0;
      }

      div.sidebar .button {
        display: flex;
        margin: 0;
        padding: 0;
        border: 0px solid transparent;
        background: transparent;
        background-clip: padding-box;
        line-height: calc(0.75rem * 1.5);
        backface-visibility: hidden;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        width: fit-content;
        height: 48px;
        cursor: pointer;
      }

      div.sidebar .button {
          opacity: 1.0;
          transition: .5s;
      }

      div.sidebar .button .icon {
        margin: 0;
        padding: 0;
        width: 0.5rem;
        height: 0.5rem;
        font-size: 0.5rem;
        line-height: 0;
        transition: .5s;
      }

      div.sidebar .button.is-animatable:hover {
        opacity: 0.5;
        transition: .5s;
      }

      div.sidebar .button:disabled {
          opacity: 0.5 !important;
          transition: .5s;
      }

      div.sidebar .button:disabled .icon.is-rotatable {
        animation: loading 1s linear forwards infinite;
        animation-play-state: running;
      }

      div.sidebar .button.is-recording .icon {
        animation: processing 1s linear forwards infinite;
        animation-play-state: running;
      }

      div.sidebar .button .clip {
        position: relative;
        display: flex;
        overflow: hidden;
        height: calc(0.75rem * 1.5);
        box-sizing: border-box;
      }

      div.sidebar .button .scrollable {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
        margin: 0px -4px 0px -4px !important;
        transform: translate3d(0%, 0%, 0);
        transition: 0.5s ease-in;
      }

      div.sidebar .button .scrollable:hover {
        transform: translate3d(-100%, 0%, 0);
        transition: 0.5s ease-out;
      }

      div.sidebar .button .scrollable div {
        display: flex;
        align-items: center;
        margin: 0px 4px 0px 4px !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 0.75rem !important;
        line-height: 0.75rem !important;
        height: calc(0.75rem * 1.5);
        vertical-align: middle;
      }

      div.sidebar .button .scrollable div:last-child:not(:first-child) {
        position: absolute;
        left: 100%;
      }

      div.sidebar .button .wrap {
        position: relative;
        display: flex;
        margin: 0;
        border-top: 2px solid transparent;
        border-bottom: 2px solid transparent;
        color: #000000;
        width: fit-content;
        height: fit-content;
        min-height: fit-content;
        box-sizing: border-box;
        overflow: hidden;
        justify-content: flex-start;
        align-items: center;
        transform: translate3d(0, 0, 0);
        transition: 0.5s;
      }

      .icon {
        display: inline-block;
        justify-items: center;
        margin: 0;
        padding: 0;
        color: #000000;
        width: fit-content;
        height: fit-content;
        transition: .5s;
        line-height: 0;
        align-items: center;
        justify-content: center;
      }

      .icon figure {
        margin: 0;
      }

      .button>figure {
        opacity: 1;
        transition: .5s;
      }

      .button:hover>figure {
        opacity: 0.5;
        transition: .5s;
      }

      .icon figure>picture {
        display: block;
      }

      .icon:first-child+div,
      .icon:not(:first-of-type) {
        margin: 0px 0px 0px 16px;
      }

      .icon.is-animatable figure {
        display: flex;
        justify-content: flex-start;
        align-items: flex-start;
        overflow: hidden;
        width: 32px;
        height: 32px;
      }

      .icon.is-animatable figure>picture {
        margin-left: 0%;
        width: auto;
        height: 100%;
        animation: frame 1.33s steps(4) infinite forwards;
      }

      .icon.is-animatable figure>picture>img {
        object-fit: none;
        object-position: 0% 0%;
        width: 100%;
        height: 100%;
      }

      .icon.is-animatable+div {
        margin: 0;
      }

      .icon.is-animatable+div>p {
        margin: 8px 0px 0px 0px;
      }

      .content .reveal {
        color: #0000;
        background: linear-gradient(var(--foreground-color) 0 0) no-repeat, linear-gradient(var(--foreground-color) 0 0) no-repeat;
        background-clip: padding-box, text;
        background-size: 0% 100%;
        animation: mask 1.0s ease 0.5s both, reveal 1.0s ease 1.5s both;
      }

      .content>div>div>div a {
        opacity: 1.0;
        backface-visibility: hidden;
        transition: opacity .5s;
      }

      .content>div>div>div a:hover {
        opacity: 0.5;
        transition: .5s;
      }

      .content>div>div>div .graph {
        position: relative;
        margin: 8px 0px 0px 0px;
        width: 48px;
        height: 4px;
        background-color: rgb(0 231 255 / 0.25);
        background-color: color(display-p3 0.0 0.906 1.0 / 0.25);
        overflow: hidden;
      }

      .content>div>div>div .graph>.bar {
        position: absolute;
        height: 100%;
        background: url('/images/Stripes.png') 0 0 repeat;
        background-color: #00e7ff;
        background-color: color(display-p3 0.0 0.906 1.0);
        background-size: 24px 24px;
        overflow: hidden;
        animation: progress 10s linear forwards infinite;
      }

      .content>div>div>div .graph>.bar>div {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        background-color: transparent;
      }

      .content>div>div>div .graph>.bar>div::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, transparent 0%, rgb(255 255 255 / 0.5) 50%, transparent 100%);
        transform: translateX(-200%) skewX(-45deg);
        animation: shine 5s infinite;
        z-index: 1;
        pointer-events: none;
      }

      .content>div>div>div.is-playable {
        opacity: 1.0;
        backface-visibility: hidden;
        transition: opacity .5s;
      }

      .content>div>div>div.is-playable:hover {
        cursor: pointer;
        opacity: 0.5;
        transition: .5s;
      }

      .content>div>div>div.is-playable>p.is-generated {
        opacity: 1.0;
        transition: .5s;
      }

      .content>div>div>div.is-playable>p.is-generated.is-loading {
        animation: processing 1s linear forwards infinite;
        animation-play-state: running;
      }

      .content>div>div>div>.is-playable {
        opacity: 1.0;
        backface-visibility: hidden;
        transition: opacity .5s;
      }

      .content>div>div>div>.is-playable:hover {
        cursor: pointer;
        opacity: 0.5;
        transition: .5s;
      }

      .content>div>div>div>.is-playable.is-generated>div {
        opacity: 1.0;
        transition: .5s;
      }

      .content>div>div>div>.is-playable.is-generated>div.is-loading {
        animation: processing 1s linear forwards infinite;
        animation-play-state: running;
      }

      #apricot:not(.is-active) {
        opacity: 0;
        transition: .5s;
      }

      #apricot.is-active {
        opacity: 1;
        transition: .5s;
      }

      #apricot canvas.likability {
        background: rgb(255 255 255 / 1.0) !important;
      }

      #apricot div.popup {
        background: rgb(255 255 255 / 1.0) !important;
        box-shadow: 0 .5em 1em -.125em #0a0a0a1a, 0 0 0 1px #0a0a0a05 !important;
      }

      #apricot div.popup::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, transparent 0%, rgb(255 255 255 / 0.5) 50%, transparent 100%);
        transform: translateX(-200%) skewX(-45deg);
        animation: shine 5s infinite;
        z-index: 1;
        pointer-events: none;
      }

      #apricot div.popup>button {
        color: #000000 !important;
        font-family: "Barlow", "Roboto", "Helvetica", "Segoe UI", "Arial", sans-serif;
        font-size: 1.0rem !important;
        font-weight: bold !important;
        line-height: 2.0rem !important;
      }

      #apricot div.popup>button:not(:last-child) {
        border-bottom: 1px solid hsl(0, 0%, 93%) !important;
      }

      #apricot span.stats {
        margin: 0;
        padding: 1px;
        background-color: #000000;
        font-family: "Barlow", "M PLUS Rounded 1c", sans-serif;
        font-size: 0.75rem;
        font-weight: bold;
        line-height: 0.75rem;
        height: 0.75rem;
        vertical-align: middle;
        color: #ffffff;
        opacity: 0;
        transition: .5s;
      }

      #apricot span.stats:hover {
        opacity: 1;
        transition: .5s;
      }

      @keyframes fade {
        from {
          opacity: 0;
        }

        to {
          opacity: 1;
        }
      }

      @keyframes mask{
        to {
          background-size: 150% 100%;
        }
      }

      @keyframes reveal {
        to {
          background-position: calc(-200% + 1px) 0, 0 0;
        }
      }

      @keyframes frame {
        0% {
          margin-left: 0%;
        }

        100% {
          margin-left: -400%;
        }
      }

      @keyframes loading {
          0% {
              transform: rotate(0deg);
          }

          100% {
              transform: rotate(360deg);
          }
      }

      @keyframes processing {
          0% {
              opacity: 1;
          }

          50% {
            opacity: 0.5;
          }

          100% {
            opacity: 1;
          }
      }

      @keyframes progress {
          0% {
              background-position: 0px 0px;
          }

          100% {
              background-position: -24px 0px;
          }
      }

      @keyframes shine {
        0% {
          transform: translateX(-200%) skewX(-45deg);
        }
        100% {
          transform: translateX(200%) skewX(-45deg);
        }
      }

      @media screen and (-webkit-min-device-pixel-ratio: 2),
      (min-resolution: 2dppx) {
          .content>div>div>div .graph>.bar {
              background: url('/images/Stripes@2x.png') 0 0 repeat;
              background-color: #00e7ff;
              background-color: color(display-p3 0.0 0.906 1.0);
              background-size: 24px 24px;
          }
      }

      @media screen and (-webkit-min-device-pixel-ratio: 3),
      (min-resolution: 3dppx) {
          .content>div>div>div .graph>.bar {
              background: url('/images/Stripes@3x.png') 0 0 repeat;
              background-color: #00e7ff;
              background-color: color(display-p3 0.0 0.906 1.0);
              background-size: 24px 24px;
          }
      }

      @media screen and (min-width: 769px) and (min-height: 769px) {
        html {
          background: var(--background-color);
        }

        body>.wrap {
          padding: 16px;
          transition: 0.5s;
        }

        body>.warp>.frame {
          border-radius: 4px;
          transition: 0.5s;
        }

        body>.overlay {
          padding: 32px;
          mask-image: linear-gradient(to bottom, transparent, transparent 16px, black 32px, black calc(100% - 32px), transparent calc(100% - 16px), transparent), linear-gradient(black, black);
          mask-size: calc(100% - 32px) 100%, 32px 100%;
          transition: 0.5s;
        }

        .overlay>.wrap>.content {
          box-sizing: border-box;
          margin: 0;
          padding: 0px 0px 32px 0px;
          transition: padding 0.5s;
        }

        .overlay>.wrap>.content .icon.is-animatable {
          right: 32px;
        }

        div.sidebar {
          left: 16px;
          height: calc(100% - 64px);
          transition: 0.5s;
        }
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="frame">
      </div>
    </div>
    <div class="overlay">
      <div class="sidebar">
        <div class="level">
          <div class="level-item">
            <div class="level">
              <div class="level-item">
                <div class="rotation-outer">
                  <div class="rotation-inner">
                    <div class="rotate">
                      <a class="button" href="https://milchchan.com/" title="milchchan.com">
                        <div class="stack">
                          <div class="wrap has-text-weight-bold is-uppercase">
                            <div class="clip">
                              <div class="scrollable">
                                <div>milchchan.com</div>
                                <div>milchchan.com</div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="level-item">
                <div class="rotation-outer">
                <div class="rotation-inner">
                    <div class="rotate">
                    <button class="button is-animatable" type="button" title="Reload" onclick="reload(event);">
                        <span class="icon is-rotatable">
                          <i class="fa-solid fa-arrows-rotate"></i>
                        </span>
                    </button>
                    </div>
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="content" data-type="milch" data-prompt="ちょっと毒舌で自虐的だが読者を傷つけないユーモアを交えながら、解説とレビューを日記であることは明示せず日記調で書いてください。" data-language="ja">
          <div>
            <h1>
              <span class="reveal">News</span>
            </h1>
            <h2>
              <span class="reveal has-text-weight-bold">ミルヒちゃんニュース</span>
            </h2>
            <div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script type="module">
      const threshold = new URL(window.location.href).searchParams.get("threshold") ?? 0.75;
      const temperature = new URL(window.location.href).searchParams.get("temperature") ?? 1.0;
      const sort = new URL(window.location.href).searchParams.get("sort") ?? "timestamp";
      const order = new URL(window.location.href).searchParams.get("order") ?? "desc";
      let isPlaying = false;
      let audioContext = null;
      let sampleRate = 32000;

      function random(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);

        return Math.floor(Math.random() * (max - min)) + min;
      }

      async function resize(blob, length) {
        return await new Promise(async (resolve, reject) => {
          const reader = new FileReader();

          reader.onload = () => {
            const image = new Image();

            image.onload = () => {
              const canvas = document.createElement("canvas");

              if (image.width>image.height) {
                if (image.width>length) {
                  canvas.width = length;
                  canvas.height = Math.floor(
                    (length / image.width) * image.height
                  );
                } else {
                  canvas.width = image.width;
                  canvas.height = image.height;
                }
              } else if (image.height>length) {
                canvas.width = Math.floor(
                  (length / image.height) * image.width
                );
                canvas.height = length;
              } else {
                canvas.width = image.width;
                canvas.height = image.height;
              }

              const ctx = canvas.getContext("2d");

              ctx.imageSmoothingEnabled = true;
              ctx.imageSmoothingQuality = "high";
              ctx.clearRect(0, 0, canvas.width, canvas.height);
              ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
              ctx.canvas.toBlob(async (blob) => {
                resolve(blob);

                ctx.canvas.width = ctx.canvas.height = 0;
              }, "image/png");
            };
            image.onerror = (error) => {
              reject(error);
            };
            image.crossOrigin = "anonymous";
            image.src = reader.result;
          };
          reader.onerror = () => {
            reject(reader.error);
          };
          reader.readAsDataURL(blob);
        });
      }

      function shake(element, isRotate = false) {
        if (isRotate) {
          element.animate([
            { transform: "translate3d(0, 5px, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(0, -5px, 0)" },
            { transform: "translate3d(0, 4px, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(0, -4px, 0)" },
            { transform: "translate3d(0, 3px, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(0, -3px, 0)" },
            { transform: "translate3d(0, 2px, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(0, -2px, 0)" },
            { transform: "translate3d(0, 1px, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(0, -1px, 0)" }],
            { fill: "forwards", duration: 500, iterations: 1 }).onfinish = () => {
              element.style.transform = "translate3d(0, 0, 0)";
            };
        } else {
          element.animate([
            { transform: "translate3d(5px, 0, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(-5px, 0, 0)" },
            { transform: "translate3d(4px, 0, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(-4px, 0, 0)" },
            { transform: "translate3d(3px, 0, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(-3px, 0, 0)" },
            { transform: "translate3d(2px, 0, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(-2px, 0, 0)" },
            { transform: "translate3d(1px, 0, 0)" },
            { transform: "translate3d(0, 0, 0)" },
            { transform: "translate3d(-1px, 0, 0)" }],
            { fill: "forwards", duration: 500, iterations: 1 }).onfinish = () => {
              element.style.transform = "translate3d(0, 0, 0)";
            };
        }
      }

      async function change(url) {
        const background = document.createElement("div");
        const image = document.createElement("div");

        background.className = "background";
        background.style.opacity = 0;
        background.style.transform = "scale3d(1.1, 1.1, 1.1)";

        document.body.querySelector(".wrap>.frame").prepend(background);
        background.appendChild(image);

        try {
          const response = await fetch(url);

          if (response.ok) {
            image.style.backgroundImage = `url('${await new Promise(async (resolve, reject) => {
              const reader = new FileReader();

              reader.onload = () => {
                resolve(reader.result);
              };
              reader.onerror = () => {
                reject(reader.error);
              };
              reader.readAsDataURL(await resize(await response.blob(), Math.max(window.screen.width, window.screen.height) * window.devicePixelRatio));
            })}')`;
          }
        } catch (error) {
          console.error(error);
        }

        for (const element of document.body.querySelectorAll(".wrap>.frame>.background")) {
          if (element !== background) {
            element.animate([
                {
                opacity: 0,
                transform: "scale3d(1.1, 1.1, 1.1)",
                },
            ], {
                delay: 0,
                fill: "forwards",
                duration: 500,
                iterations: 1,
                easing: "ease-in"
            }).onfinish = () => {
                element.remove();
            };
          }
        }

        background.animate([
          {
            opacity: 1,
            transform: "scale3d(1.0, 1.0, 1.0)",
          },
        ], {
          delay: 0,
          fill: "forwards",
          duration: 500,
          iterations: 1,
          easing: "ease-out"
        }).onfinish = () => {
          background.style.opacity = 1;
          background.style.transform = "scale3d(1.0, 1.0, 1.0)";
        };
      }

      async function synthesize(source, prompt, input, language, temperature = 1.0) {
        const response1 = await fetch(encodeURI(prompt));

        if (response1.ok) {
          const formData = new FormData();

          formData.append("file", await response1.blob(), "prompt.wav");
          formData.append("data", JSON.stringify({ input: input, language: language, temperature: temperature }));

          const response2 = await fetch("https://milchchan.com/api/generate", {
            mode: "cors",
            method: "POST",
            body: formData
          });

          if (response2.ok) {
            const blob = await response2.blob();
            const [arrayBuffer, sr] = await new Promise(async (resolve, reject) => {
              const reader = new FileReader();

              reader.onload = () => {
                const arrayBuffer = reader.result;
                const view = new DataView(arrayBuffer);
                const sampleRate = view.getUint32(24, true);
                
                resolve([arrayBuffer, sampleRate]);
              };
              reader.onerror = () => {
                reject(reader.error);
              };
              reader.readAsArrayBuffer(blob);
            });

            const buffer = await audioContext.decodeAudioData(arrayBuffer);

            sampleRate = sr;
            
            source.buffer = buffer;
            source.onended = () => {
              source.disconnect();
              audioContext.close();
              audioContext = null;
              isPlaying = false;
            };
            source.start(0);
            isPlaying = true;
          } else {
            throw new Error(response2.statusText);
          }

        }
      }
      
      window.reload = (event) => {
        const reloadButton = document.body.querySelector("div.sidebar>.level>.level-item:first-child>.level>.level-item:nth-child(2) .button");
        
        if (reloadButton !== null) {
          for (const element1 of document.body.querySelectorAll("div.overlay>.wrap>.content")) {
            const element2 = element1.querySelector(":scope>div:last-of-type");

            if (element2 !== null) {
              reloadButton.disabled = true;
              reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) + 1;
              
              element2.animate([
                {
                  opacity: 0
                }
              ], {
                  delay: 0,
                  fill: "forwards",
                  duration: 500,
                  iterations: 1,
                  easing: "ease-in",
                  composite: "replace"
              }).onfinish = (event) => {
                const div = document.createElement("div");
                
                for (const element3 of Array.from(element2.children)) {
                  for (const element4 of Array.from(element3.children)) {
                    for (const element5 of Array.from(element4.children)) {
                      if (element5.classList.contains("is-generated")) {
                        element4.remove();
                        
                        break;
                      }
                    }
                  }

                  element3.remove();
                  div.appendChild(element3);
                }

                element2.replaceWith(div);
                element1.dataset["generated"] = false;

                new Promise(async (resolve, reject) => {
                  try {
                    const response = await fetch(encodeURI(`https://milchchan.com/api/fetch?sort=${sort}&order=${order}`));

                    if (response.ok) {
                      const json = await response.json();
                      const past = new Date.now() - 24 * 60 * 60 * 1000;
                      const items = [];

                      for (const item of json) {
                        if (item["score"] >= threshold) {
                          const timestamp = Math.floor(item["timestamp"] * 1000);

                          if (timestamp > past) {
                            item["timestamp"] = new Date(timestamp);
                            items.push(item);
                          }
                        }
                      }

                      resolve([items, JSON.stringify(items)]);
                    } else {
                      throw new Error(response.statusText);
                    }
                  } catch (error) {
                    reject(error);
                  }
                }).then((data) => {
                  const last = div.querySelector(":scope>div:last-of-type");

                  if (last !== null) {
                    const [items, raw] = data;

                    for (const item of items) {
                      const wrap = document.createElement("div");
                      const section1 = document.createElement("div");
                      const section2 = document.createElement("div");
                      const graph = document.createElement("div");
                      const bar = document.createElement("div");
                      const p = document.createElement("p");
                      const a = document.createElement("a");
                      const span1 = document.createElement("span");
                      const span2 = document.createElement("span");
                      const span3 = document.createElement("span");

                      p.classList.add("is-generated");
                      a.href = item["url"];
                      a.target = "_blank";
                      a.rel = "noopener noreferrer";
                      span1.classList.add("reveal");
                      span1.textContent = item["content"];
                      span2.classList.add("reveal");
                      span2.textContent = item["timestamp"].toLocaleString();
                      section1.classList.add("is-generated");
                      span3.classList.add("reveal");
                      span3.textContent = new URL(item["url"]).host;
                      section2.classList.add("is-generated");
                      graph.classList.add("is-generated");
                      graph.classList.add("graph");
                      graph.style.opacity = 0;
                      bar.classList.add("bar");
                      bar.style.width = `${Math.floor(item["score"] * 100)}%`;

                      a.appendChild(span1);
                      p.appendChild(a);
                      wrap.appendChild(p);
                      
                      if ("comment" in item && item["comment"] !== null) {
                        const section = document.createElement("div");
                        const temp = document.createElement("div");
                        const span = document.createElement("span");
                        
                        section.classList.add("is-generated");
                        span.classList.add("reveal");
                        span.classList.add("is-italic");
                        span.textContent = item["comment"];
                        
                        temp.appendChild(span);
                        section.appendChild(temp);
                        wrap.appendChild(section);

                        if ("language" in element1.dataset) {
                          section.classList.add("is-playable");
                          temp.onclick = async () => {
                            if (!temp.classList.contains("is-loading") && !isPlaying) {
                              temp.classList.add("is-loading");
                              
                              audioContext = audioContext ?? new window.AudioContext({ sampleRate: sampleRate });
                                    
                              const source = audioContext.createBufferSource();
                                    
                              source.connect(audioContext.destination);

                              try {
                                await synthesize(source, `/sounds/${element1.dataset.type}.${element1.dataset.language}.wav`, item["comment"], element1.dataset.language, temperature);
                              } catch (error) {
                                shake(section);

                                console.error(error);
                              }

                              temp.classList.remove("is-loading");
                            }
                          };
                        }
                      }

                      section1.appendChild(span2);
                      section2.appendChild(span3);
                      bar.appendChild(document.createElement("div"));
                      graph.appendChild(bar);
                      wrap.appendChild(section1);
                      wrap.appendChild(section2);
                      wrap.appendChild(graph);
                      last.appendChild(wrap);

                      graph.animate([
                        {
                          opacity: 1,
                        },
                      ], {
                          delay: 1000,
                          fill: "forwards",
                          duration: 1000,
                          iterations: 1,
                          easing: "ease-out"
                      }).onfinish = () => {
                          graph.style.opacity = 1;
                      };
                    }

                    /*new Promise(async (resolve, reject) => {
                      try {
                        const response1 = await fetch(encodeURI(`/${element1.dataset.type}.txt`));

                        if (response1.ok) {
                          const response2 = await fetch("https://milchchan.com/api/generate", {
                            mode: "cors",
                            method: "POST",
                            headers: {
                              "Content-Type": "application/json"
                            },
                            body: JSON.stringify({temperature: temperature, messages: [{role: "system", content: await response1.text()}, {role: "user", content: `${element1.dataset.prompt}\n\n\`\`\`\njson${raw}\n\`\`\``}], tools: []})
                          });

                          if (response2.ok) {
                            const response3 = await fetch(window.devicePixelRatio > 1 ? `/images/PixelatedMilch-Transformed@${Math.trunc(window.devicePixelRatio)}x.png` : "/images/PixelatedMilch-Transformed.png");

                            if (response3.ok) {
                                const dataURL = await new Promise(async (resolve, reject) => {
                                const reader = new FileReader();

                                reader.onload = () => {
                                  resolve(reader.result);
                                };
                                reader.onerror = () => {
                                  reject(reader.error);
                                };
                                reader.readAsDataURL(await response3.blob());
                              });

                              resolve([(await response2.json()).content, dataURL]);
                            } else {
                              throw new Error(response3.statusText);
                            }
                          } else {
                            throw new Error(response2.statusText);
                          }
                        } else {
                          throw new Error(response1.statusText);
                        }
                      } catch (error) {
                        reject(error);
                      }
                    }).then((data) => {
                      const [text, dataURL] = data;
                      const icon = document.createElement("div");
                      const figure = document.createElement("figure");
                      const picture = document.createElement("picture");
                      const img = document.createElement("img");

                      icon.classList.add("icon");
                      icon.classList.add("is-animatable");
                      icon.style.opacity = 0;
                      figure.classList.add("is-generated");

                      icon.classList.add("icon");
                      figure.classList.add("is-generated");
                      picture.classList.add("is-animatable");
                      img.srcset = `${dataURL} ${window.devicePixelRatio > 1 ? `${Math.trunc(window.devicePixelRatio)}` : "1"}x`;

                      picture.appendChild(img);
                      figure.appendChild(picture);
                      icon.appendChild(figure);
                      last.appendChild(icon);

                      for (const content of text.split("\n")) {
                        const wrap = document.createElement("div");
                        const p = document.createElement("p");
                        const span = document.createElement("span");
                        
                        p.classList.add("is-generated");

                        if ("language" in element1.dataset) {
                          wrap.classList.add("is-playable");

                          p.onclick = async () => {
                            if (!p.classList.contains("is-loading") && !isPlaying) {
                              p.classList.add("is-loading");
                              
                              audioContext = audioContext ?? new window.AudioContext({ sampleRate: sampleRate });
                                    
                              const source = audioContext.createBufferSource();
                                    
                              source.connect(audioContext.destination);

                              try {
                                await synthesize(source, `/sounds/${element1.dataset.type}.${element1.dataset.language}.wav`, content, element1.dataset.language, temperature);
                              } catch (error) {
                                shake(p);

                                console.error(error);
                              }

                              p.classList.remove("is-loading");
                            }
                          };
                        }

                        span.classList.add("reveal");
                        span.classList.add("is-italic");
                        span.textContent = content;

                        p.appendChild(span);
                        wrap.appendChild(p);
                        last.appendChild(wrap);
                      }

                      icon.animate([
                        {
                          opacity: 1,
                        },
                      ], {
                          delay: 1000,
                          fill: "forwards",
                          duration: 1000,
                          iterations: 1,
                          easing: "ease-out"
                      }).onfinish = () => {
                          icon.style.opacity = 1;
                      };

                      element1.dataset["generated"] = true;
                      reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

                      if (reloadButton.dataset["counter"] === "0") {
                        reloadButton.disabled = false;
                      }
                    }).catch((error) => {
                      delete element1.dataset["generated"];

                      reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

                      if (reloadButton.dataset["counter"] === "0") {
                        reloadButton.disabled = false;
                      }

                      shake(reloadButton, true);

                      console.error(error);
                    });

                    return;*/
                  }

                  element1.dataset["generated"] = true;
                  reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

                  if (reloadButton.dataset["counter"] === "0") {
                    reloadButton.disabled = false;
                  }
                }).catch((error) => {
                  delete element1.dataset["generated"];

                  reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

                  if (reloadButton.dataset["counter"] === "0") {
                    reloadButton.disabled = false;
                  }

                  shake(reloadButton, true);

                  console.error(error);
                });
              };
            }
          }
        }
      };

      window.addEventListener("load", async (event) => {
        for (const element of document.body.querySelectorAll("div.overlay>.wrap>.content")) {
          const background = document.createElement("div");
          const image = document.createElement("div");

          background.className = "background";
          background.style.opacity = 0;
          background.style.transform = "scale3d(1.1, 1.1, 1.1)";
          
          document.body.querySelector(".wrap>.frame").prepend(background);
          background.appendChild(image);

          const reloadButton = document.body.querySelector("div.sidebar>.level>.level-item:first-child>.level>.level-item:nth-child(2) .button");
          
          if (reloadButton !== null) {
            reloadButton.disabled = true;
            reloadButton.dataset["counter"] = 1;
            
            new Promise(async (resolve, reject) => {
              try {
                  const response = await fetch(window.getComputedStyle(document.documentElement).getPropertyValue(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches ? `--${element.dataset.type}-dark-background-image` : `--${element.dataset.type}-light-background-image`));

                  if (response.ok) {
                      image.style.backgroundImage = `url('${await new Promise(async (resolve, reject) => {
                          const reader = new FileReader();

                          reader.onload = () => {
                              resolve(reader.result);
                          };
                          reader.onerror = () => {
                              reject(reader.error);
                          };
                          reader.readAsDataURL(await resize(await response.blob(), Math.max(window.screen.width, window.screen.height) * window.devicePixelRatio));
                      })}')`;
                  }
              } catch (error) {
                  console.error(error);
              }
              
              background.animate([
                {
                  opacity: 1,
                  transform: "scale3d(1.0, 1.0, 1.0)",
                },
              ], {
                  delay: 0,
                  fill: "forwards",
                  duration: 500,
                  iterations: 1,
                  easing: "ease-out"
              }).onfinish = () => {
                  background.style.opacity = 1;
                  background.style.transform = "scale3d(1.0, 1.0, 1.0)";
              };

              element.dataset["generated"] = false;

              try {
                const response = await fetch(encodeURI(`https://milchchan.com/api/fetch?sort=${sort}&order=${order}`));

                if (response.ok) {
                  const json = await response.json();
                  const past = new Date.now() - 24 * 60 * 60 * 1000;
                  const items = [];

                  for (const item of json) {
                    if (item["score"] >= threshold) {
                      const timestamp = Math.floor(item["timestamp"] * 1000);

                      if (timestamp > past) {
                        item["timestamp"] = new Date(timestamp);
                        items.push(item);
                      }
                    }
                  }

                  resolve([items, JSON.stringify(items)]);
                } else {
                  throw new Error(response.statusText);
                }
              } catch (error) {
                reject(error);
              }
            }).then((data) => {
              const div = element.querySelector(":scope>div>div:last-of-type");

              if (div !== null) {
                const [items, raw] = data;

                for (const item of items) {
                  const wrap = document.createElement("div");
                  const section1 = document.createElement("div");
                  const section2 = document.createElement("div");
                  const graph = document.createElement("div");
                  const bar = document.createElement("div");
                  const p = document.createElement("p");
                  const a = document.createElement("a");
                  const span1 = document.createElement("span");
                  const span2 = document.createElement("span");
                  const span3 = document.createElement("span");

                  p.classList.add("is-generated");
                  a.href = item["url"];
                  a.target = "_blank";
                  a.rel = "noopener noreferrer";
                  span1.classList.add("reveal");
                  span1.textContent = item["content"];
                  span2.classList.add("reveal");
                  span2.textContent = item["timestamp"].toLocaleString();
                  section1.classList.add("is-generated");
                  span3.classList.add("reveal");
                  span3.textContent = new URL(item["url"]).host;
                  section2.classList.add("is-generated");
                  graph.classList.add("is-generated");
                  graph.classList.add("graph");
                  graph.style.opacity = 0;
                  bar.classList.add("bar");
                  bar.style.width = `${Math.floor(item["score"] * 100)}%`;

                  a.appendChild(span1);
                  p.appendChild(a);
                  wrap.appendChild(p);
                  
                  if ("comment" in item && item["comment"] !== null) {
                    const section = document.createElement("div");
                    const temp = document.createElement("div");
                    const span = document.createElement("span");
                    
                    section.classList.add("is-generated");
                    span.classList.add("reveal");
                    span.classList.add("is-italic");
                    span.textContent = item["comment"];
                    
                    temp.appendChild(span);
                    section.appendChild(temp);
                    wrap.appendChild(section);

                    if ("language" in element.dataset) {
                      section.classList.add("is-playable");
                      temp.onclick = async () => {
                        if (!temp.classList.contains("is-loading") && !isPlaying) {
                          temp.classList.add("is-loading");
                          
                          audioContext = audioContext ?? new window.AudioContext({ sampleRate: sampleRate });
                                
                          const source = audioContext.createBufferSource();
                                
                          source.connect(audioContext.destination);

                          try {
                            await synthesize(source, `/sounds/${element.dataset.type}.${element.dataset.language}.wav`, item["comment"], element.dataset.language, temperature);
                          } catch (error) {
                            shake(section);

                            console.error(error);
                          }

                          temp.classList.remove("is-loading");
                        }
                      };
                    }
                  }

                  section1.appendChild(span2);
                  section2.appendChild(span3);
                  bar.appendChild(document.createElement("div"));
                  graph.appendChild(bar);
                  wrap.appendChild(section1);
                  wrap.appendChild(section2);
                  wrap.appendChild(graph);
                  div.appendChild(wrap);

                  graph.animate([
                    {
                      opacity: 1,
                    },
                  ], {
                      delay: 1000,
                      fill: "forwards",
                      duration: 1000,
                      iterations: 1,
                      easing: "ease-out"
                  }).onfinish = () => {
                      graph.style.opacity = 1;
                  };
                }

                /*new Promise(async (resolve, reject) => {
                  try {
                    const response1 = await fetch(encodeURI(`/${element.dataset.type}.txt`));

                    if (response1.ok) {
                      const response2 = await fetch("https://milchchan.com/api/generate", {
                        mode: "cors",
                        method: "POST",
                        headers: {
                          "Content-Type": "application/json"
                        },
                        body: JSON.stringify({temperature: temperature, messages: [{role: "system", content: await response1.text()}, {role: "user", content: `${element.dataset.prompt}\n\n\`\`\`json\n${raw}\n\`\`\``}], tools: []})
                      });

                      if (response2.ok) {
                        const response3 = await fetch(window.devicePixelRatio > 1 ? `/images/PixelatedMilch-Transformed@${Math.trunc(window.devicePixelRatio)}x.png` : "/images/PixelatedMilch-Transformed.png");

                        if (response3.ok) {
                          const dataURL = await new Promise(async (resolve, reject) => {
                            const reader = new FileReader();

                            reader.onload = () => {
                              resolve(reader.result);
                            };
                            reader.onerror = () => {
                              reject(reader.error);
                            };
                            reader.readAsDataURL(await response3.blob());
                          });

                          resolve([(await response2.json()).content, dataURL]);
                        } else {
                          throw new Error(response3.statusText);
                        }
                      } else {
                        throw new Error(response2.statusText);
                      }
                    } else {
                      throw new Error(response1.statusText);
                    }
                  } catch (error) {
                    reject(error);
                  }
                }).then((data) => {
                  const [text, dataURL] = data;
                  const icon = document.createElement("div");
                  const figure = document.createElement("figure");
                  const picture = document.createElement("picture");
                  const img = document.createElement("img");
                  
                  icon.classList.add("icon");
                  icon.classList.add("is-animatable");
                  icon.style.opacity = 0;
                  figure.classList.add("is-generated");
                  img.srcset = `${dataURL} ${window.devicePixelRatio > 1 ? `${Math.trunc(window.devicePixelRatio)}` : "1"}x`;

                  picture.appendChild(img);
                  figure.appendChild(picture);
                  icon.appendChild(figure);
                  div.appendChild(icon);

                  for (const content of text.split("\n")) {
                    const wrap = document.createElement("div");
                    const p = document.createElement("p");
                    const span = document.createElement("span");
                    
                    p.classList.add("is-generated");

                    if ("language" in element.dataset) {
                      wrap.classList.add("is-playable");

                      p.onclick = async () => {
                        if (!p.classList.contains("is-loading") && !isPlaying) {
                          p.classList.add("is-loading");
                          
                          audioContext = audioContext ?? new window.AudioContext({ sampleRate: sampleRate });
                                
                          const source = audioContext.createBufferSource();
                                
                          source.connect(audioContext.destination);

                          try {
                            await synthesize(source, `/sounds/${element.dataset.type}.${element.dataset.language}.wav`, content, element.dataset.language, temperature);
                          } catch (error) {
                            shake(p);

                            console.error(error);
                          }

                          p.classList.remove("is-loading");
                        }
                      };
                    }

                    span.classList.add("reveal");
                    span.classList.add("is-italic");
                    span.textContent = content;

                    p.appendChild(span);
                    wrap.appendChild(p);
                    div.appendChild(wrap);
                  }

                  icon.animate([
                    {
                      opacity: 1,
                    },
                  ], {
                      delay: 1000,
                      fill: "forwards",
                      duration: 1000,
                      iterations: 1,
                      easing: "ease-out"
                  }).onfinish = () => {
                      icon.style.opacity = 1;
                  };

                  element.dataset["generated"] = true;
                  reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

                  if (reloadButton.dataset["counter"] === "0") {
                    reloadButton.disabled = false;
                  }
                }).catch((error) => {
                  delete element.dataset["generated"];

                  reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

                  if (reloadButton.dataset["counter"] === "0") {
                    reloadButton.disabled = false;
                  }

                  shake(reloadButton, true);

                  console.error(error);
                });

                return;*/
              }

              element.dataset["generated"] = true;
              reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

              if (reloadButton.dataset["counter"] === "0") {
                reloadButton.disabled = false;
              }
            }).catch((error) => {
              delete element.dataset["generated"];

              reloadButton.dataset["counter"] = parseInt(reloadButton.dataset["counter"]) - 1;

              if (reloadButton.dataset["counter"] === "0") {
                reloadButton.disabled = false;
              }

              shake(reloadButton, true);

              console.error(error);
            });
          }
        }
      });
      window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (e) => {
        for (const element of document.body.querySelectorAll("div.overlay>.wrap>.content")) {
          if (element.classList.contains("is-selected")) {
            change(window.getComputedStyle(document.documentElement).getPropertyValue(e.matches ? `--${element.dataset.type}-dark-background-image` : `--${element.dataset.type}-light-background-image`));
          }
        }
      });
    </script>
  </body>
</html>
